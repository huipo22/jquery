<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        canvas{
            background: #ccc;
        }
    </style>
    <script>
        /*localStorage.a="zs"
        alert(localStorage.a)*/
       /* localStorage.setItem("aa","bb");
        localStorage.setItem("cc","dd");
        alert(localStorage.getItem("aa"));
        localStorage.removeItem("aa")*/
//        localStorage.clear()
/*    window.onload=function(){
        var canvas=document.getElementsByTagName("canvas")[0];
        var cobj=canvas.getContext("2d");
//        var colorObj=cobj.createLinearGradient(0,0,100,100);
        /!*var colorObj=cobj.createRadialGradient(150,150,0,150,150,50)
        colorObj.addColorStop(0,"#000");
        colorObj.addColorStop(0.5,"pink";
        colorObj.addColorStop(1,"red");
        cobj.fillStyle=colorObj;
        cobj.fillRect(0,0,100,100);
        cobj.strokeRect(100,10,100,100);*!/
//        cobj.rect(0.5,0.5,100,100);
//        cobj.fill()
//        cobj.stroke();
        cobj.beginPath();
        cobj.moveTo(50,50);
        cobj.lineTo(150,150);
        cobj.closePath()
        cobj.stroke();

        cobj.beginPath();
        cobj.lineTo(200,0)
        cobj.lineTo(300,100);
        cobj.closePath()
        cobj.stroke();

    }*/
        /*铅笔*/
        /*window.onload=function(){
            var canvas=document.getElementsByTagName("canvas")[0];
            var cobj=canvas.getContext("2d");
            canvas.onmousedown=function(e){
                var startX=e.offsetX;
                var startY=e.offsetY;
                cobj.beginPath();
                cobj.moveTo(startX,startY);
                canvas.onmousemove=function(e){
                    var endX= e.offsetX;
                    var endY= e.offsetY;
                    cobj.lineTo(endX,endY);
                    cobj.stroke();
                }
                canvas.onmouseup=function(){
                    cobj.closePath();
                    canvas.onmousemove=null;
                    canvas.onmouseup=null;
                }
            }
        }*/
        /*直线*/
        window.onload=function(){
            var canvas=document.getElementsByTagName("canvas")[0];
            var cobj=canvas.getContext("2d");
            var arr=[];/*新建一个数组*/
            canvas.onmousedown=function(e){
                var startX=e.offsetX;
                var startY=e.offsetY;
                canvas.onmousemove=function(e){
                    /*清空画布*/
                    cobj.clearRect(0,0,canvas.width,canvas.height);
                    /*判断是否为空
                        不为空
                    */
                    if(arr.length!=0){
                        /*不为空  将内容呈放到画布中*/
                        cobj.putImageData(arr[arr.length-1],0,0)
                    }
                    var endX= e.offsetX;
                    var endY= e.offsetY;
                    cobj.beginPath();
                    cobj.moveTo(startX,startY);
                    cobj.lineTo(endX,endY);
                    cobj.stroke();
                    cobj.closePath();
                }
                canvas.onmouseup=function(){
                    /*鼠标抬起  将cobj.getImageData(0,0,canvas.width,canvas.height))的内容放入到数组中*/
                    arr.push(cobj.getImageData(0,0,canvas.width,canvas.height))
                    canvas.onmousemove=null;
                    canvas.onmouseup=null;
                }
            }
            var btn=document.getElementsByTagName("input")[0];
            btn.onclick=function(){
                if(arr.length>1){
                    arr.pop();
                    cobj.putImageData(arr[arr.length-1],0,0);
                }else{
                    return;
                }
                /*var last=arr.pop();/!*最后一个元素*!/
                console.log(last)
                cobj.clearRect(0,0,canvas.width,canvas.height);
                cobj.putImageData(last,0,0)*/
            }
        }
    </script>
</head>
<body>
    <canvas width="600px" height="400px"></canvas>
    <input type="button" value="回退">
</body>
</html>